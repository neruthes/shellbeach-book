%!TEX TS-program = xelatex
%!TEX encoding = UTF-8 Unicode

\documentclass[a4paper,twosided,10pt]{book}

\usepackage[a4paper,textwidth=42em,tmargin=25mm,bmargin=27mm,bindingoffset=17mm]{geometry}
\usepackage[dvipsnames]{xcolor}
\usepackage{calc}
\usepackage{amsmath,xltxtra,xunicode}
\usepackage{titlesec}
\usepackage{fontspec}
\usepackage{fancyhdr}
\usepackage{datetime2}
\usepackage{wasysym,oz,pxfonts,txfonts}


\usepackage{tcolorbox}
\usepackage{qrcode}
\usepackage{indentfirst}


\usepackage[PunctStyle=plain,RubberPunctSkip=false]{xeCJK}
\defaultCJKfontfeatures{Script=CJK}
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt

% =========================================
\usepackage[hidelinks]{hyperref}
\hypersetup{
    colorlinks=false,
    pdftitle={Shell Beach (2022)},
    pdfpagemode=FullScreen,
}
\usepackage{listings,paralist}
\setdefaultleftmargin{3em}{2em}{1em}{1em}{1em}{1em}

\usepackage{enumerate,enumitem}
\usepackage{longtable}
\usepackage{tabu}

\usepackage{tocloft}
\renewcommand{\contentsname}{\sffamily{目录}\vspace{30pt}\hrule\vspace{2pt}}
\renewcommand{\cftchapfont}{\vspace{0pt}\mdseries\rmfamily}
\renewcommand{\cftchappagefont}{\vspace{0pt}\mdseries\rmfamily}
\setlength{\cftbeforechapskip}{0pt}
\newcommand{\mybookpart}[1]{
    \addcontentsline{toc}{chapter}{\linebreak\textbf{\Large#1}\vspace{7pt}}
    \part*{#1}
}

\usepackage{graphicx}
\graphicspath{ {/home/neruthes/DEV/shellbeach-book/img/} }

\usepackage{etoolbox}
\patchcmd{\quote}{\rightmargin}{\leftmargin 2em \rightmargin}{}{}

\usepackage[bottom]{footmisc}
\renewcommand*{\footnotelayout}{\footnotesize\rmfamily\fontspec{Noto Serif CJK SC}\CJKfontspec{Noto Serif CJK SC}}

% \usepackage[sfdefault]{inter}
\usepackage[OT1,T1]{fontenc}
% \renewcommand*\familydefault{\ttdefault}

% Bad roman fonts: Times New Roman, NewComputerModern, Noto Serif, Theano Modern, Spectral
% Good roman fonts: Domitian, Palatino, QTPalatine
\setmainfont{QTPalatine}
\setromanfont{QTPalatine}
% \usepackage{kpfonts}
% \usepackage{TheanoModern}
% \usepackage{txfonts}
\setsansfont{Inter}
\setmonofont{Libertinus Mono}
\setCJKmainfont{Noto Serif CJK SC}
\setCJKromanfont{Noto Serif CJK SC}
\setCJKsansfont{Noto Sans CJK SC}
\setCJKmonofont{Noto Sans CJK SC}


\title{Shell Beach (2022)}
\author{白色灯塔先生}
\date{2022}
% =========================================

% =========================================
% START CORPORATION CONFIG
% \setlength{\parindent}{0pt}
\setlength{\parindent}{2em}
\setlength{\parskip}{8pt}
% END CORPORATION CONFIG
% =========================================

% =========================================
% START COMMON STYLESHEET

% END COMMON STYLESHEET
% =========================================




\pagestyle{fancy}
\renewcommand{\headrule}{}
% \fancyhf{}
% \fancyhead[LE,RO]{\sffamily Shell Beach}
% \fancyhead[LO,RE]{\sffamily \thechapter}
% \fancyhead[C]{}
% \fancyfoot[LE,RO]{\itshape\small{\thepage}}
% \fancyfoot[LO,RE]{}
% \fancyfoot[C]{}


\fancypagestyle{plain}{
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    \fancyhf{}
    \rhead{}
    \chead{}
    \lhead{}
    \rfoot{}
    \cfoot{}
    \lfoot{}
}
\fancypagestyle{fancy}{
    \fancyhf{}
    \renewcommand{\headrule}{}
    \fancyhead[LE,RO]{\small\sffamily Shell Beach}
    \fancyhead[LO,RE]{\small\sffamily \#2022-\leftpad{\thechapter}}
    \fancyhead[C]{}
    \fancyfoot[LE,RO]{\small{\thepage}}
    \fancyfoot[LO,RE]{}
    \fancyfoot[C]{}
}





\makeatletter\@addtoreset{chapter}{part}\makeatother%

\newcommand{\useimg}[1]{
    \noindent\begin{minipage}{\linewidth}
        \centering
        \vspace{3pt}
        \includegraphics[width=\textwidth-8em,keepaspectratio,height=0.5\textheight]{#1}
        \vspace{3pt}
    \end{minipage}
}
\newcommand{\midnote}[1]{
    \noindent{\sffamily\footnotesize\hfill#1\hfill}
}
\newcommand{\pozhehao}[0]{%
    {\fontspec{FandolSong}\CJKfontspec{FandolSong}——}%
}
\newcommand{\twochartab}[0]{%
    {\hspace{2em}}%
}
\newcommand{\ardate}[2]{
    \noindent\begin{minipage}{\textwidth}
        \noindent{%
            \ttfamily\small#1%
        } \hfill {%
            \footnotesize
            \sffamily
            \fontspec{Noto Sans Mono Condensed}
            \href{https://mp.weixin.qq.com/s/#2}{https://mp.weixin.qq.com/s/#2}%
        }%
    \end{minipage}

    \vspace{8pt}
    \hrule
    \vspace{30pt}
}
\newcommand{\blockquote}[1]{
    \begin{quote}
        \normalsize
        \rmfamily
        % \fontspec{GFS Bodoni}
        % \fontspec{FandolKai}
        \fontspec{NewComputerModern}
        \CJKfontspec{FandolKai}
        % \itshape
        #1
    \end{quote}
}
\newcommand{\blockquotesource}[3]{
    % $1=title $2=author $3=year
    \par{\footnotesize\sffamily
        \hfill
        #1
        \hspace{0.5em}·\hspace{0.5em}
        #2
        \hspace{0.5em}·\hspace{0.5em}
        #3%
    }%
}
\newcommand{\citebook}[1]{
    \par{\small\sffamily
        \hfill
        #1
    }\par
}
\newcommand{\dialoguelist}[2]{
    % $1=namewidth $2=content
    \begin{description}[widest=A#1,leftmargin=*,font=\mdseries\rmfamily\CJKfontspec{FandolKai}\itshape]%
        #2%
    \end{description}%
}
\newcommand{\dialoguelistthin}[2]{
    % $1=namewidth $2=content
    \blockquote{%
        \dialoguelist{#1}{#2}%
    }%
}
\newcommand{\dialogue}[2]{
    \item[#1] \textrm{#2}%
}
\newlength{\dialogueseplinenamewidth}
\newcommand{\dialoguesepline}[2]{
    % $1=actorNameColWidthExample $2=content
    % \item \textsf{\hfill\footnotesize #2\hfill{\color{white}AA#1}}
    \settowidth{\dialogueseplinenamewidth}{#1}
    \item \begin{minipage}{\linewidth-\dialogueseplinenamewidth-1em}
        \sffamily\centering\footnotesize
        #2
    \end{minipage}
}
\newcommand{\threestars}[0]{
    {*\hspace{1em}*\hspace{1em}*}
}
\newcommand{\tristarsepline}[0]{
    \noindent\begin{minipage}{\textwidth}
        \center
        \noindent
        \threestars
    \end{minipage}
}
\newcommand\ifootnote[1]{%
    \begingroup
    \renewcommand\thefootnote{}\footnote{#1}%
    \addtocounter{footnote}{-1}%
    \endgroup
}
\newcommand{\makedraftdeclaration}[0]{
    \clearpage
    
    \hspace{0.5\linewidth}
    \vspace{0.4\textheight}
    
    {\hfill\sffamily{以下为尚未完工的草稿}\hfill}
    
    \vfill
    
    \clearpage
}
\newcommand{\leftpad}[1]{\ifnum#1<100 0\ifnum#1<10 0\fi\fi#1}
% \newcommand{\leftpad}[1]{\ifnum\thechapter<100 0\ifnum\thechapter<10 0\fi\fi\thechapter}


% \titleformat{\chapter}[display]{\huge\bfseries}{\raggedright\mdseries\normalsize\fontspec{SF Pro Text}Article \thechapter\linebreak}{0pt}{\LARGE\bfseries}
\titleformat{\chapter}[display]{\small\mdseries\rmfamily\fontspec{Noto Serif CJK SC}}{\raggedright\mdseries\large\ttfamily \#2022-\leftpad{\thechapter}\vspace{10pt}}{0pt}{\Large\bfseries}



\linespread{1.16}



\begin{document}
\raggedbottom
\pagestyle{empty}
\rmfamily\mdseries\normalsize



\newgeometry{hmargin=50mm,tmargin=50mm,bmargin=50mm}% For A4 paper
% \newgeometry{hmargin=20mm,tmargin=30mm,bmargin=30mm}% For A5 paper
\begin{titlepage}
    \center

    \parindent=0pt
    \sffamily
    \includegraphics[width=60mm]{shellbeach-avatar.jpg}
    \vspace{20pt}

    \Huge
    {\fontspec{Noto Serif Display}\bfseries{Shell Beach}}

    \vspace{20pt}

    \normalsize
    二零二二年度公众号文章合集\\
    持续更新中

	\vfill

	\sffamily
    白色灯塔先生

\end{titlepage}
\newgeometry{textwidth=42em,tmargin=25mm,bmargin=27mm,bindingoffset=17mm}% For A4 paper
% \newgeometry{textwidth=32em,tmargin=20mm,bmargin=15mm,bindingoffset=13mm}% For A5 paper


\rmfamily
\normalsize





% \chapter*{前言}

% Hello world!

\cleardoublepage

\setcounter{tocdepth}{0}
\textmd{\sffamily\tableofcontents}
\cleardoublepage
\setcounter{page}{1}


% \pagestyle{myheadings}
% \pagestyle{plain}
\pagestyle{fancy}
% \part{2022 Q1}
% ======================================
% BEGIN LIST
\input{/home/neruthes/DEV/shellbeach-book/2022/articles-list.tex}
% END LIST
% ======================================




\cleardoublepage
\pagestyle{empty}
\hspace{1pt}
\vfill
{
	\footnotesize
	\raggedright
	\sffamily
	\fontspec{Inter}


    \qrcode[link,height=30mm]{http://weixin.qq.com/r/sD8OChHEO9lHKVVpb2o0}
    \vspace{10mm}

    
    白色灯塔先生 \copyright{} 2022 版权所有

    \begin{description}[widest=,leftmargin=*,font=\mdseries\sffamily]%
        \item[构建日期] \today
        \item[装帧设计] Neruthes
    \end{description}
}
\end{document}
